<div class="flex flex-col min-h-screen bg-gray-100 dark:bg-gray-800 transition-colors duration-300">
  <app-header></app-header>
  <div class="flex flex-grow">
    <main class="flex-grow p-4 rounded-3xl">
      <router-outlet></router-outlet>
    </main>
  </div>
  <app-footer></app-footer>
  <app-toast-notification></app-toast-notification>
</div>
@if (isModalVisible) {
  <app-modal
    [isOpen]="isModalVisible"
    title="Converter em Nota"
    confirmText="Confirmar"
    cancelText="Cancelar"
    (onConfirm)="confirmConvertToNote()"
    (onCancel)="cancelConvertToNote()"
  >
    <div class="mb-4">
      <label id="noteTitleLabel" for="noteTitle" class="block text-gray-700 dark:text-dark-text-secondary font-bold mb-2">Título da Nota:</label>
      <input type="text" id="noteTitle" [(ngModel)]="newNoteTitle" aria-labelledby="noteTitleLabel" class="w-full p-2 border rounded-lg dark:bg-dark-primary dark:border-dark-border dark:text-white">
    </div>

    <div class="mb-6">
      @if (!isCreatingNewNotebook) {
        <label id="notebookSelectLabel" for="notebookSelect" class="block text-gray-700 dark:text-dark-text-secondary font-bold mb-2">Salvar no Caderno:</label>
        <select id="notebookSelect" [(ngModel)]="selectedNotebookIdForNote" aria-labelledby="notebookSelectLabel" class="w-full p-2 border rounded-lg dark:bg-dark-primary dark:border-dark-border dark:text-white">
          <option [ngValue]="null" disabled>Selecione um caderno</option>
          @for (notebook of notebooks; track notebook.id) {
            <option [value]="notebook.id">{{ notebook.name }}</option>
          }
        </select>
        <button (click)="isCreatingNewNotebook = true" aria-label="Criar novo caderno" class="mt-2 text-blue-600 hover:underline dark:text-blue-400">+ Criar novo caderno</button>
      } @else {
        <label id="newNotebookNameLabel" for="newNotebookName" class="block text-gray-700 dark:text-dark-text-secondary font-bold mb-2">Nome do Novo Caderno:</label>
        <input type="text" id="newNotebookName" [(ngModel)]="newNotebookName" aria-labelledby="newNotebookNameLabel" class="w-full p-2 border rounded-lg dark:bg-dark-primary dark:border-dark-border dark:text-white">
        <div class="mt-2 flex gap-2">
          <button (click)="createNewNotebookFromModal()" [disabled]="!newNotebookName.trim()" aria-label="Salvar novo caderno" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Salvar Caderno</button>
          <button (click)="isCreatingNewNotebook = false; newNotebookName = ''" aria-label="Cancelar criação de novo caderno" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400 dark:bg-dark-accent dark:text-white dark:hover:bg-dark-border">Cancelar</button>
        </div>
      }
    </div>

    <div class="mb-4">
      <input type="checkbox" id="deleteClip" [(ngModel)]="deleteClipAfterConversion" aria-describedby="deleteClipDescription">
      <label id="deleteClipDescription" for="deleteClip" class="ml-2 text-gray-700 dark:text-dark-text-secondary">Limpar Clip após conversão</label>
    </div>

    @if (isCreatingNote) {
      <p class="mt-2 dark:text-dark-text-secondary">Salvando...</p>
    }
  </app-modal>
}
